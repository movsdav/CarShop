@using CarShop.Models.Chat
@model ChatChannel
@{
    string currentUserId = (string)ViewData["CurrentUserId"];
    var otherUser = Model.User1Id == currentUserId ? Model.User2 : Model.User1;
    var otherUserImgUrl = Model.User1Id == currentUserId ? Model.User1.ImgUrl : Model.User2.ImgUrl;
    
}

<div class="chat-header">
    <img src="@otherUser.ImgUrl" alt="User Avatar" class="rounded-circle mr-3 contact-avatar">
    <h5 class="mb-0">@otherUser.FullName</h5>
</div>

<div class="chat-body">
    @if (Model.Messages.Count > 0)
    {
        foreach (var msg in Model.Messages)
        {
            if (msg.SenderId == currentUserId)
            {
                <div class="row justify-content-end">
                    <div class="col-md-6">
                        <div class="message-box sender-message">
                            <p>@msg.Content</p>
                            <small class="text-muted">12:30 PM</small>
                        </div>
                    </div>
                </div>
            }
            else
            {
                <div class="row">
                    <div class="col-md-6">
                        <div class="message-box receiver-message">
                            <p>@msg.Content</p>
                            <small class="text-muted">12:35 PM</small>
                        </div>
                    </div>
                </div>
            }
        }
    }
</div>

<div class="chat-footer">
    <form asp-action="SendMessage" method="post">
        @Html.Hidden("SenderId", currentUserId)
        @Html.Hidden("ReceiverId", otherUser.Id)
        @Html.Hidden("ChatChannelId",Model.Id)
        <div class="input-group">
            <input name="Content" type="text" class="form-control" placeholder="Type your message" aria-label="Type your message" aria-describedby="button-addon2">
            <button class="btn btn-primary" type="submit" id="button-addon2">Send</button>
        </div>
    </form>
</div>